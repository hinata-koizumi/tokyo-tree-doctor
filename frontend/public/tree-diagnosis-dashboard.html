<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>樹木診断ダッシュボード</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans JP', sans-serif;
            background: #f8f9fa;
            color: #2c3e50;
            overflow: hidden;
        }

        /* トップバー */
        .topbar {
            height: 60px;
            background: linear-gradient(135deg, #2c5282 0%, #2d7a4e 100%);
            display: flex;
            align-items: center;
            padding: 0 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1000;
        }

        .topbar h1 {
            color: white;
            font-size: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .topbar .logo {
            width: 32px;
            height: 32px;
            background: rgba(255,255,255,0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        /* メインコンテナ */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
            position: relative;
        }

        /* 左サイドパネル */
        .sidebar {
            width: 380px;
            background: white;
            box-shadow: 2px 0 8px rgba(0,0,0,0.05);
            padding: 24px;
            overflow-y: auto;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* KPIカード */
        .kpi-section {
            margin-bottom: 32px;
        }

        .section-title {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 16px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .kpi-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .kpi-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }

        .kpi-card.danger {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-color: #fca5a5;
        }

        .kpi-card.warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-color: #fbbf24;
        }

        .kpi-card.safe {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: #86efac;
        }

        .kpi-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .kpi-card.danger .kpi-value {
            color: #dc2626;
        }

        .kpi-card.warning .kpi-value {
            color: #f59e0b;
        }

        .kpi-card.safe .kpi-value {
            color: #10b981;
        }

        .kpi-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 500;
        }

        /* 進捗バー */
        .progress-bar {
            height: 8px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            display: flex;
        }

        .progress-segment {
            transition: width 0.5s ease;
        }

        .progress-segment.danger {
            background: #dc2626;
        }

        .progress-segment.warning {
            background: #f59e0b;
        }

        .progress-segment.safe {
            background: #10b981;
        }

        /* 優先度リスト */
        .priority-section {
            margin-top: 32px;
        }

        .priority-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .priority-item {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
            cursor: pointer;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .priority-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transform: translateX(4px);
        }

        .priority-number {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
        }

        .priority-content {
            flex: 1;
        }

        .priority-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: #1f2937;
        }

        .priority-details {
            font-size: 12px;
            color: #6b7280;
            display: flex;
            gap: 12px;
        }

        .priority-badge {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .badge-danger {
            background: #fef2f2;
            color: #dc2626;
        }

        .badge-warning {
            background: #fffbeb;
            color: #f59e0b;
        }

        /* 地図コンテナ */
        .map-container {
            flex: 1;
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* カスタムマーカースタイル */
        .custom-marker {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .custom-marker:hover {
            transform: scale(1.2);
        }

        .marker-danger {
            background: #dc2626;
        }

        .marker-warning {
            background: #f59e0b;
        }

        .marker-safe {
            background: #10b981;
        }

        /* ポップアップスタイル */
        .leaflet-popup-content-wrapper {
            border-radius: 12px;
            padding: 0;
            overflow: hidden;
        }

        .popup-content {
            padding: 16px;
            min-width: 280px;
        }

        .popup-header {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 12px;
            color: #1f2937;
        }

        .popup-details {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .popup-detail-row {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .popup-detail-label {
            color: #6b7280;
        }

        .popup-detail-value {
            font-weight: 600;
            color: #1f2937;
        }

        .popup-action {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
        }

        .popup-action:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        /* モバイル対応 */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }

            .mobile-panel {
                position: absolute;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-radius: 24px 24px 0 0;
                padding: 24px;
                box-shadow: 0 -4px 16px rgba(0,0,0,0.1);
                z-index: 1000;
                max-height: 50vh;
                overflow-y: auto;
            }

            .mobile-kpi-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
                margin-bottom: 20px;
            }

            .mobile-kpi-item {
                text-align: center;
                padding: 12px;
                background: #f9fafb;
                border-radius: 12px;
            }

            .mobile-kpi-value {
                font-size: 24px;
                font-weight: 700;
                margin-bottom: 4px;
            }

            .mobile-kpi-label {
                font-size: 11px;
                color: #6b7280;
            }
        }

        /* ローディングアニメーション */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid #e5e7eb;
            border-top-color: #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- トップバー -->
    <div class="topbar">
        <h1>
            <div class="logo">🌳</div>
            樹木診断ダッシュボード
        </h1>
    </div>

    <!-- メインコンテナ -->
    <div class="main-container">
        <!-- 左サイドパネル -->
        <div class="sidebar">
            <!-- KPIセクション -->
            <div class="kpi-section">
                <h2 class="section-title">診断結果サマリー</h2>
                
                <div class="kpi-cards">
                    <div class="kpi-card danger" onclick="filterMarkers('danger')">
                        <div class="kpi-value">8</div>
                        <div class="kpi-label">危険</div>
                    </div>
                    <div class="kpi-card warning" onclick="filterMarkers('warning')">
                        <div class="kpi-value">15</div>
                        <div class="kpi-label">要注意</div>
                    </div>
                    <div class="kpi-card safe" onclick="filterMarkers('safe')">
                        <div class="kpi-value">42</div>
                        <div class="kpi-label">健全</div>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-segment danger" style="width: 12.3%"></div>
                    <div class="progress-segment warning" style="width: 23.1%"></div>
                    <div class="progress-segment safe" style="width: 64.6%"></div>
                </div>
            </div>

            <!-- 優先度リスト -->
            <div class="priority-section">
                <h2 class="section-title">対策優先度 TOP 5</h2>
                
                <div class="priority-list">
                    <div class="priority-item" onclick="focusTree(35.6895, 139.6917)">
                        <div class="priority-number">1</div>
                        <div class="priority-content">
                            <div class="priority-title">ID: TR-2024-045</div>
                            <div class="priority-details">
                                <span>VARI: 0.12</span>
                                <span>樹齢: 85年</span>
                                <span class="priority-badge badge-danger">即対応</span>
                            </div>
                        </div>
                    </div>

                    <div class="priority-item" onclick="focusTree(35.6885, 139.6925)">
                        <div class="priority-number">2</div>
                        <div class="priority-content">
                            <div class="priority-title">ID: TR-2024-018</div>
                            <div class="priority-details">
                                <span>VARI: 0.18</span>
                                <span>樹齢: 72年</span>
                                <span class="priority-badge badge-danger">即対応</span>
                            </div>
                        </div>
                    </div>

                    <div class="priority-item" onclick="focusTree(35.6905, 139.6905)">
                        <div class="priority-number">3</div>
                        <div class="priority-content">
                            <div class="priority-title">ID: TR-2024-032</div>
                            <div class="priority-details">
                                <span>VARI: 0.25</span>
                                <span>樹齢: 68年</span>
                                <span class="priority-badge badge-warning">要監視</span>
                            </div>
                        </div>
                    </div>

                    <div class="priority-item" onclick="focusTree(35.6875, 139.6935)">
                        <div class="priority-number">4</div>
                        <div class="priority-content">
                            <div class="priority-title">ID: TR-2024-089</div>
                            <div class="priority-details">
                                <span>VARI: 0.28</span>
                                <span>樹齢: 55年</span>
                                <span class="priority-badge badge-warning">要監視</span>
                            </div>
                        </div>
                    </div>

                    <div class="priority-item" onclick="focusTree(35.6915, 139.6895)">
                        <div class="priority-number">5</div>
                        <div class="priority-content">
                            <div class="priority-title">ID: TR-2024-067</div>
                            <div class="priority-details">
                                <span>VARI: 0.32</span>
                                <span>樹齢: 48年</span>
                                <span class="priority-badge badge-warning">定期観察</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 地図コンテナ -->
        <div class="map-container">
            <div id="map"></div>
            <div class="loading">
                <div class="loading-spinner"></div>
            </div>
        </div>

        <!-- モバイル用パネル（768px以下で表示） -->
        <div class="mobile-panel" style="display: none;">
            <div class="mobile-kpi-grid">
                <div class="mobile-kpi-item">
                    <div class="mobile-kpi-value" style="color: #dc2626;">8</div>
                    <div class="mobile-kpi-label">危険</div>
                </div>
                <div class="mobile-kpi-item">
                    <div class="mobile-kpi-value" style="color: #f59e0b;">15</div>
                    <div class="mobile-kpi-label">要注意</div>
                </div>
                <div class="mobile-kpi-item">
                    <div class="mobile-kpi-value" style="color: #10b981;">42</div>
                    <div class="mobile-kpi-label">健全</div>
                </div>
            </div>
            <h3 style="font-size: 14px; margin-bottom: 12px; color: #6b7280;">優先対応</h3>
            <div style="padding: 12px; background: #fef2f2; border-radius: 8px; border-left: 4px solid #dc2626;">
                <div style="font-weight: 600; margin-bottom: 4px;">TR-2024-045</div>
                <div style="font-size: 12px; color: #6b7280;">VARI: 0.12 | 即対応推奨</div>
            </div>
        </div>
    </div>

    <script>
        // Leafletが読み込まれるまで待機
        window.addEventListener('DOMContentLoaded', function() {
            // 地図の初期化
            const map = L.map('map').setView([35.689, 139.692], 15);

        // タイルレイヤーの追加
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // サンプルデータ
        const treeData = [
            // 危険な樹木
            { id: 'TR-2024-045', lat: 35.6895, lng: 139.6917, status: 'danger', vari: 0.12, age: 85, height: 22, recommendation: '即座の伐採を推奨' },
            { id: 'TR-2024-018', lat: 35.6885, lng: 139.6925, status: 'danger', vari: 0.18, age: 72, height: 18, recommendation: '即座の伐採を推奨' },
            { id: 'TR-2024-091', lat: 35.6888, lng: 139.6912, status: 'danger', vari: 0.15, age: 78, height: 20, recommendation: '緊急点検が必要' },
            { id: 'TR-2024-104', lat: 35.6892, lng: 139.6908, status: 'danger', vari: 0.20, age: 65, height: 19, recommendation: '即座の対応が必要' },
            { id: 'TR-2024-127', lat: 35.6897, lng: 139.6903, status: 'danger', vari: 0.14, age: 82, height: 23, recommendation: '伐採を検討' },
            { id: 'TR-2024-135', lat: 35.6883, lng: 139.6928, status: 'danger', vari: 0.19, age: 70, height: 17, recommendation: '緊急対応が必要' },
            { id: 'TR-2024-142', lat: 35.6886, lng: 139.6922, status: 'danger', vari: 0.16, age: 75, height: 21, recommendation: '即座の点検が必要' },
            { id: 'TR-2024-156', lat: 35.6894, lng: 139.6915, status: 'danger', vari: 0.13, age: 88, height: 24, recommendation: '伐採を強く推奨' },
            
            // 要注意の樹木
            { id: 'TR-2024-032', lat: 35.6905, lng: 139.6905, status: 'warning', vari: 0.25, age: 68, height: 16, recommendation: '3ヶ月以内の再診断' },
            { id: 'TR-2024-089', lat: 35.6875, lng: 139.6935, status: 'warning', vari: 0.28, age: 55, height: 15, recommendation: '定期監視を継続' },
            { id: 'TR-2024-067', lat: 35.6915, lng: 139.6895, status: 'warning', vari: 0.32, age: 48, height: 14, recommendation: '6ヶ月後に再評価' },
            { id: 'TR-2024-023', lat: 35.6878, lng: 139.6932, status: 'warning', vari: 0.30, age: 52, height: 15, recommendation: '枝の剪定を検討' },
            { id: 'TR-2024-078', lat: 35.6912, lng: 139.6898, status: 'warning', vari: 0.35, age: 45, height: 13, recommendation: '経過観察を継続' },
            { id: 'TR-2024-056', lat: 35.6902, lng: 139.6902, status: 'warning', vari: 0.27, age: 60, height: 17, recommendation: '次回診断時に重点確認' },
            { id: 'TR-2024-034', lat: 35.6908, lng: 139.6892, status: 'warning', vari: 0.33, age: 42, height: 12, recommendation: '成長状態を監視' },
            { id: 'TR-2024-098', lat: 35.6872, lng: 139.6938, status: 'warning', vari: 0.29, age: 58, height: 16, recommendation: '土壌改良を検討' },
            { id: 'TR-2024-112', lat: 35.6918, lng: 139.6888, status: 'warning', vari: 0.31, age: 50, height: 14, recommendation: '定期的な観察が必要' },
            { id: 'TR-2024-076', lat: 35.6882, lng: 139.6918, status: 'warning', vari: 0.34, age: 46, height: 13, recommendation: '成長促進処置を検討' },
            { id: 'TR-2024-043', lat: 35.6898, lng: 139.6907, status: 'warning', vari: 0.26, age: 62, height: 18, recommendation: '枝の整理が必要' },
            { id: 'TR-2024-021', lat: 35.6876, lng: 139.6930, status: 'warning', vari: 0.36, age: 40, height: 11, recommendation: '栄養状態の改善' },
            { id: 'TR-2024-087', lat: 35.6910, lng: 139.6900, status: 'warning', vari: 0.28, age: 56, height: 15, recommendation: '病害虫の予防処置' },
            { id: 'TR-2024-065', lat: 35.6904, lng: 139.6896, status: 'warning', vari: 0.32, age: 47, height: 13, recommendation: '土壌水分の管理' },
            { id: 'TR-2024-054', lat: 35.6880, lng: 139.6920, status: 'warning', vari: 0.30, age: 53, height: 14, recommendation: '周辺環境の整備' },
            
            // 健全な樹木（一部のみ表示）
            { id: 'TR-2024-001', lat: 35.6900, lng: 139.6910, status: 'safe', vari: 0.68, age: 35, height: 12, recommendation: '問題なし' },
            { id: 'TR-2024-002', lat: 35.6890, lng: 139.6920, status: 'safe', vari: 0.72, age: 28, height: 10, recommendation: '健全な状態' },
            { id: 'TR-2024-003', lat: 35.6880, lng: 139.6915, status: 'safe', vari: 0.75, age: 32, height: 11, recommendation: '良好' },
            { id: 'TR-2024-004', lat: 35.6895, lng: 139.6925, status: 'safe', vari: 0.70, age: 30, height: 10, recommendation: '問題なし' },
            { id: 'TR-2024-005', lat: 35.6885, lng: 139.6910, status: 'safe', vari: 0.78, age: 25, height: 9, recommendation: '非常に健全' },
            { id: 'TR-2024-006', lat: 35.6905, lng: 139.6915, status: 'safe', vari: 0.73, age: 33, height: 11, recommendation: '良好な状態' },
            { id: 'TR-2024-007', lat: 35.6875, lng: 139.6925, status: 'safe', vari: 0.69, age: 38, height: 12, recommendation: '健全' },
            { id: 'TR-2024-008', lat: 35.6910, lng: 139.6905, status: 'safe', vari: 0.76, age: 27, height: 9, recommendation: '問題なし' },
            { id: 'TR-2024-009', lat: 35.6870, lng: 139.6930, status: 'safe', vari: 0.71, age: 31, height: 10, recommendation: '良好' },
            { id: 'TR-2024-010', lat: 35.6915, lng: 139.6910, status: 'safe', vari: 0.74, age: 29, height: 10, recommendation: '健全な成長' },
            { id: 'TR-2024-011', lat: 35.6888, lng: 139.6905, status: 'safe', vari: 0.77, age: 26, height: 9, recommendation: '非常に良好' },
            { id: 'TR-2024-012', lat: 35.6892, lng: 139.6895, status: 'safe', vari: 0.70, age: 34, height: 11, recommendation: '問題なし' },
            { id: 'TR-2024-013', lat: 35.6878, lng: 139.6908, status: 'safe', vari: 0.72, age: 30, height: 10, recommendation: '健全' },
            { id: 'TR-2024-014', lat: 35.6907, lng: 139.6920, status: 'safe', vari: 0.75, age: 28, height: 9, recommendation: '良好な状態' },
            { id: 'TR-2024-015', lat: 35.6873, lng: 139.6912, status: 'safe', vari: 0.68, age: 36, height: 12, recommendation: '問題なし' }
        ];

        // マーカーグループ
        const markerGroups = {
            danger: L.layerGroup(),
            warning: L.layerGroup(),
            safe: L.layerGroup()
        };

        // マーカーの作成
        treeData.forEach(tree => {
            const markerIcon = L.divIcon({
                className: `custom-marker marker-${tree.status}`,
                iconSize: [24, 24]
            });

            const marker = L.marker([tree.lat, tree.lng], { icon: markerIcon });
            
            // ポップアップの作成
            const popupContent = `
                <div class="popup-content">
                    <div class="popup-header">樹木 ${tree.id}</div>
                    <div class="popup-details">
                        <div class="popup-detail-row">
                            <span class="popup-detail-label">状態</span>
                            <span class="popup-detail-value" style="color: ${
                                tree.status === 'danger' ? '#dc2626' : 
                                tree.status === 'warning' ? '#f59e0b' : '#10b981'
                            }">
                                ${tree.status === 'danger' ? '危険' : 
                                  tree.status === 'warning' ? '要注意' : '健全'}
                            </span>
                        </div>
                        <div class="popup-detail-row">
                            <span class="popup-detail-label">VARI値</span>
                            <span class="popup-detail-value">${tree.vari}</span>
                        </div>
                        <div class="popup-detail-row">
                            <span class="popup-detail-label">樹齢</span>
                            <span class="popup-detail-value">${tree.age}年</span>
                        </div>
                        <div class="popup-detail-row">
                            <span class="popup-detail-label">樹高</span>
                            <span class="popup-detail-value">${tree.height}m</span>
                        </div>
                        <div class="popup-detail-row">
                            <span class="popup-detail-label">推奨対策</span>
                            <span class="popup-detail-value">${tree.recommendation}</span>
                        </div>
                    </div>
                    <button class="popup-action" onclick="showDetails('${tree.id}')">
                        詳細レポートを表示
                    </button>
                </div>
            `;
            
            marker.bindPopup(popupContent);
            markerGroups[tree.status].addLayer(marker);
        });

        // すべてのマーカーを地図に追加
        Object.values(markerGroups).forEach(group => {
            group.addTo(map);
        });

        // マーカーフィルタリング機能
        let currentFilter = 'all';
        
        function filterMarkers(status) {
            if (currentFilter === status) {
                // 同じフィルターをクリックしたら全表示に戻す
                Object.values(markerGroups).forEach(group => {
                    group.addTo(map);
                });
                currentFilter = 'all';
            } else {
                // 選択したステータスのマーカーのみ表示
                Object.keys(markerGroups).forEach(key => {
                    if (key === status) {
                        markerGroups[key].addTo(map);
                    } else {
                        map.removeLayer(markerGroups[key]);
                    }
                });
                currentFilter = status;
            }
        }

        // 特定の樹木にフォーカス
        function focusTree(lat, lng) {
            map.setView([lat, lng], 18, {
                animate: true,
                duration: 0.5
            });
            
            // 該当するマーカーのポップアップを開く
            markerGroups['danger'].eachLayer(layer => {
                if (layer.getLatLng().lat === lat && layer.getLatLng().lng === lng) {
                    layer.openPopup();
                }
            });
            markerGroups['warning'].eachLayer(layer => {
                if (layer.getLatLng().lat === lat && layer.getLatLng().lng === lng) {
                    layer.openPopup();
                }
            });
        }

        // 詳細レポート表示（仮の実装）
        function showDetails(id) {
            alert(`樹木 ${id} の詳細レポートを表示します。\n（実際の実装では別画面やモーダルで詳細情報を表示）`);
        }

        // モバイル対応の処理
        function checkMobile() {
            const mobilePanel = document.querySelector('.mobile-panel');
            if (window.innerWidth <= 768) {
                mobilePanel.style.display = 'block';
            } else {
                mobilePanel.style.display = 'none';
            }
        }

        window.addEventListener('resize', checkMobile);
        checkMobile();

        // 地図のサイズ調整
        setTimeout(() => {
            map.invalidateSize();
        }, 100);
        });
    </script>
</body>
</html>